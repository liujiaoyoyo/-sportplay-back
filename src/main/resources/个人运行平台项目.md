个人运动平台项目

## 1、项目概述

​		致力于做一款前后分离的个人健康平台，旨在配合热爱运动和健身的朋友们开发一款能够完成卡路里统计，运动计划编写，科学食物搭配，以及方便与其它朋友交流心得的平台。



### 1.1 需求分析

#### 1.1.1、痛点分析

​		健康平台中有需要许多的第三方数据，比如：运动卡路里的消耗、食品卡路里的提供、以及各种健身运动的卡路里消耗。需要调取大量的api接口，数据库设计考虑用户分级还有管理员权限设置。比如：普通用户和vip查看的内容区分以及功能区分。管理分为超级管理员和普通管理员。

​		页面层面使用vue+elementUI开发，分为前台管理员系统和后台业务模块。需要设计的内容有：登录、后台系统（权限管理、运动平台等）、前台业务（卡路里查询，个人计划制定，食品划分等）。

​		后台采用SpringBoot+Mybatis开发，需要提前编写各个模块的路由方便分发，创建关系型数据库。大致分为：用户、功能分支、运动列表，计划列表，卡路里列表等。

#### 1.1.2、项目架构

采取前后端分离开发，前端为vue后端为java。使用springBoot做跨域请求



前端将在vs code中的Tomcat下部署；后端将在IDEA中集成的Tomcat下部署。

## 2、框架搭建

搭建VUE+SpringBoot环境，并且使用一个登录模块来测试。

### 2.1、后台环境搭建

#### 2.1.1、创建SpringBoot 项目

使用IDEA快速搭建SpringBoot环境：File--New--Project--Spring Initializr--Next*2--选择模块【WEB（Spring WEB）&&SQL（JDBC API、MyBatis Framework，MySql Driver）】

因为mybatis需要一个数据源，所以配置一个application.yml

```yaml
# mysql
spring:
  datasource:
    #MySQL配置
    driverClassName:  com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/easyproject?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=UTC
    username: root
    password: root

mybatis:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.example.demo.model
  
server:
  port: 9000
```

启动项目：http://localhost:9000

#### 2.1.2、创建测试路由路径

编写测试Controller，注意返回值和路径映射

```java
@RestController
public class TestController {

    @RequestMapping("/test")
    public String test(){
        return "This is ok.";
    }
}
```

运行结果：

#### 2.1.3、跨域配置

```java
@Configuration
public class WebConfig extends WebMvcConfigurerAdapter {

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("http://localhost:8080", "null")
                .allowedMethods("POST", "GET", "PUT", "OPTIONS", "DELETE")
                .maxAge(3600)
                .allowCredentials(true);
    }
}
```

或者

![image-20200922093107598](E:\Download\Typora\image-20200922093107598.png)

#### 2.1.4、创建logincontroller

```java
@RestController
public class LoginController {
    @Autowired
    UserDao userDao;

    @CrossOrigin
    @RequestMapping("/login")
    public String userLogin(@RequestBody User user) {
        System.out.println("User : " + user);
        String str = "error";
        int count = userDao.getUserByMassage(user.getUsername(), user.getPassword());
        if (count > 0) {
            str = "ok";
        }
        return str;
    }
}
```

#### 2.1.5、创建UserDao

```java
@Repository
public interface UserDao {

    public int getUserByMassage(@Param("username") String username, @Param("password") String password);
}
```

#### 2.1.6、创建UserMapper.xml

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.naughty.userlogin02.dao.UserDao">
        <select id="getUserByMassage" resultType="java.lang.Integer">
       	SELECT count(id) FROM easyUser
       	WHERE username=#{username} AND password=#{password}
    </select>
</mapper>
```



### 2.2、前台开发

#### 2.2.1、创建vue项目

win+R输入cmd打开dos，运行命令：vue ui，进入：Vue 项目管理器

创建项目：

![image-20200922093923631](E:\Download\Typora\image-20200922093923631.png)

![image-20200922094009203](E:\Download\Typora\image-20200922094009203.png)

![image-20200922094131154](E:\Download\Typora\image-20200922094131154.png)

![image-20200922094147734](E:\Download\Typora\image-20200922094147734.png)

![image-20200922094245879](E:\Download\Typora\image-20200922094245879.png)

![image-20200922094308607](E:\Download\Typora\image-20200922094308607.png)

![image-20200922094354502](E:\Download\Typora\image-20200922094354502.png)

![image-20200922094416287](E:\Download\Typora\image-20200922094416287.png)

手动创建配置，选择功能：Babel、Router、使用配置然后创建项目。添加插件`elementUI`

![image-20200922100220362](E:\Download\Typora\image-20200922100220362.png)

![image-20200922100311869](E:\Download\Typora\image-20200922100311869.png)

添加依赖：`axios`、`less-loader`、`less` 然后运行vue项目

![image-20200922100443139](E:\Download\Typora\image-20200922100443139.png)

![image-20200922100515617](E:\Download\Typora\image-20200922100515617.png)

![image-20200922100629652](E:\Download\Typora\image-20200922100629652.png)

![image-20200922100708938](E:\Download\Typora\image-20200922100708938.png)

![image-20200922100800083](E:\Download\Typora\image-20200922100800083.png)

#### 2.2.2、修改项目

用vscode打开文件夹

![image-20200922100938552](E:\Download\Typora\image-20200922100938552.png)

观察目录结构：在main.js中引入了elementUI，然后引入了App.vue进行了渲染

![image-20200922101445290](E:\Download\Typora\image-20200922101445290.png)

App.vue 删除多余分支，删除About.vue和Home.vue文件，剔除index.js的分支。

![image-20200922101552101](E:\Download\Typora\image-20200922101552101.png)

![image-20200922101642689](E:\Download\Typora\image-20200922101642689.png)

![image-20200922101656370](E:\Download\Typora\image-20200922101656370.png)

删除view下的vue

![image-20200922101945577](E:\Download\Typora\image-20200922101945577.png)

```html
<template>
  <div id="app">          //注意一个项目中只能有一个id叫app的
 	App 根组件
  </div>
</template>

<script>

</script>

<style>

</style>
```

```js
//删除index.html下对view下vue的依赖和路由
import Vue from 'vue'
import VueRouter from 'vue-router'

Vue.use(VueRouter)

const routes = [
]

const router = new VueRouter({
  routes
})

export default router
```

![image-20200922102303610](E:\Download\Typora\image-20200922102303610.png)

之后能正常运行。

#### 2.2.3、创建登录页面

#####  创建Login.vue

![image-20200922102540444](E:\Download\Typora\image-20200922102540444.png)

##### 添加templete，一定要加一个根div

![image-20200922102705747](E:\Download\Typora\image-20200922102705747.png)

##### 添加script

![image-20200922102918125](E:\Download\Typora\image-20200922102918125.png)

##### 添加style，并且增加less语法

![image-20200922103007776](E:\Download\Typora\image-20200922103007776.png)

```html
<template>
    <div>
        Login
    </div>
</template>
<style lang="less" scoped>

</style>
<script>
export default {
    
}
</script>
```

##### 为login增加路由

index页面搭建好了，但是现在是无法访问的，因为vue都是单一页面index进入的，所以要修改两个地方，

一个是index页面中要引入login，并添加路由

自定义路由,重定向到login，也可以直接配置路径为"/"访问到login.vue

```js
  const routes = [
      //添加重定向
  {
    path: '/',
    redirect:'/login'
  },
      //转发，通过component去引用真正的组件
  {
    path: '/login',
    component: Login
  },
```

说明：当然也可以不做重定向，直接path：‘/’加component组件为login即可

另一个是修改App.vue把‘app根组件’；换成`<router-view>`标签,是做渲染的

![image-20200922104230994](E:\Download\Typora\image-20200922104230994.png)

刷新页面，直接跳转到Longin页面

![image-20200922104306995](E:\Download\Typora\image-20200922104306995.png)

##### 增加样式

添加全局样式：assets/css/global.css

```css
/* 全局式样 */
html,body,#app{
    height: 100%;
    margin: 0px;
    padding: 0px;
}
```

main.js里添加全局样式

```js
import './assets/css/global.css'// 添加全局样式
```

创建需要的icon文件夹 assets/font

```js
import './assets/font/iconfont.css'// 添加font-icon
```

##### 修改login.vue-表单

elementUI

https://element.eleme.cn/#/zh-CN/component/form

找一个比较全的复制前四行

![image-20200922110458444](E:\Download\Typora\image-20200922110458444.png)

![image-20200922110551251](E:\Download\Typora\image-20200922110551251.png)

对以上代码进行修改：

​	（1）这里有数据绑定form和宽度，先把宽度设置为0

​	（2）有一个类名form，但是我们这是个登录，所以改成loginFormRef吧

​	（3）绑定的数据跟登录相关的，我们就叫loginForm，有了数据绑定就要添加数据绑定，先不急；同时添加属性验证，也不急，看官方有没有提供

​	（4）给这个类添加一个样式class="login_form"

​	（5）添加用户名,同理添加密码

```vue
<el-form-item>
          <el-input v-model="loginForm.username"></el-input>
</el-form-item>
```

​	（6）添加按钮，首先要添加按钮，也把它放在</el-form-item>中，然后去官网找自己心仪的按钮样子，为了方便对按钮样式修改，给它加一个样式class="btns"

![image-20200922112045868](E:\Download\Typora\image-20200922112045868.png)

![image-20200922112145290](E:\Download\Typora\image-20200922112145290.png)

开始绑定数据：

这里loginForm还没有数据，那么就写一个函数：

![image-20200922112523333](E:\Download\Typora\image-20200922112523333.png)

最终页面效果如下：

![image-20200922112606060](E:\Download\Typora\image-20200922112606060.png)

##### 修改login.vue-表单样式

之前的样式有些丑，那么我们想给输入框加入一个图标，看图标就知道什么意思，找到ui的input输入框，然后找一个带 icon 的输入框样例：

![image-20200922113650885](E:\Download\Typora\image-20200922113650885.png)

![image-20200922113751778](E:\Download\Typora\image-20200922113751778.png)

效果如下：

![image-20200922113806782](E:\Download\Typora\image-20200922113806782.png)

但是如果想要别的呢，就去ui找icon图标：https://element.eleme.cn/#/zh-CN/component/icon

那要是以上也没有我想要的呢？阿里巴巴有个图标网站

https://www.iconfont.cn/

如何使用：新建一个项目，把想要的图标添加到对应的项目中：

在里面找对应想要的图标，找到后加入购物车后添加至项目；

然后下载到本地，解压压缩包；

里面有一个index，说明我们怎么使用图标，有unicode和font class、symbol方法，我们采用font class方式

​	（1）在main.js中引入以下代码

```js
<link rel="stylesheet" href="./iconfont.css">
```

​	（2）挑选相应图标并获取类名，应用于页面：

![image-20200922133309940](E:\Download\Typora\image-20200922133309940.png)

具体如下：

先把下载的文件copy到saaet下：

![image-20200922132935616](E:\Download\Typora\image-20200922132935616.png)

在main,js中引入：

![image-20200922133223322](E:\Download\Typora\image-20200922133223322.png)

在login中使用：

![image-20200922133449029](E:\Download\Typora\image-20200922133449029.png)

效果如下：

![image-20200922133542403](E:\Download\Typora\image-20200922133542403.png)

###### 给根元素加背景颜色

![image-20200922143604135](E:\Download\Typora\image-20200922143604135.png)

###### 添加长宽高和样式

![image-20200922144030531](E:\Download\Typora\image-20200922144030531.png)

###### 给图片设置样式

先画一个圆：

![image-20200922144246141](E:\Download\Typora\image-20200922144246141.png)

![image-20200922144351371](E:\Download\Typora\image-20200922144351371.png)

再使图片在圆里面：

![image-20200922144606420](E:\Download\Typora\image-20200922144606420.png)

###### 给表单也加上

![image-20200922145033098](E:\Download\Typora\image-20200922145033098.png)

##### 编写逻辑

###### 给输入框加入验证

![image-20200922145459116](E:\Download\Typora\image-20200922145459116.png)

![image-20200922145641930](E:\Download\Typora\image-20200922145641930.png)

所以分三步：

​	（1）添加验证属性

![image-20200922145915330](E:\Download\Typora\image-20200922145915330.png)

​	（2）创建自己的验证规则

![image-20200922150211050](E:\Download\Typora\image-20200922150211050.png)

![image-20200922151509425](E:\Download\Typora\image-20200922151509425.png)

​	（3）把验证规则对于的属性或者说元素绑定到对于标签中

![image-20200922151821652](E:\Download\Typora\image-20200922151821652.png)

###### 实现登录逻辑

​	（1）在main.js中引入axios

​	（2）把这个挂载在vue中，方便使用，即在

![image-20200922152611801](E:\Download\Typora\image-20200922152611801.png)

​	（3）设置访问跟路径

![image-20200922152815326](E:\Download\Typora\image-20200922152815326.png)

​	（4）密码框应该是不可见的

​	![image-20200922153017490](E:\Download\Typora\image-20200922153017490.png)

​	（5）编写重置按钮方法

![image-20200922153347362](E:\Download\Typora\image-20200922153347362.png)

![image-20200922153539496](E:\Download\Typora\image-20200922153539496.png)

​	（6）登录按钮方法

首先看验证成功没有，传如的参数是valid

![image-20200922154008119](E:\Download\Typora\image-20200922154008119.png)

测试test接口：

![image-20200922154222417](E:\Download\Typora\image-20200922154222417.png)

![image-20200922154554083](E:\Download\Typora\image-20200922154554083.png)

test请求成功给出提示

![image-20200922155611682](E:\Download\Typora\image-20200922155611682.png)

test请求成功跳转到home页面：所以新建一个Home.vue

![image-20200922170723232](E:\Download\Typora\image-20200922170723232.png)

注意一定在加入一个vue界面后再index.js中导入它

![image-20200922171010959](E:\Download\Typora\image-20200922171010959.png)

增加跳转：

![image-20200922171104114](E:\Download\Typora\image-20200922171104114.png)

编写真的登录请求：传loginForm对象

![image-20200922172611597](E:\Download\Typora\image-20200922172611597.png)

把返回的状态和结果存储在本地：

![image-20200922175804663](E:\Download\Typora\image-20200922175804663.png)

最后文档：

```html
<template>
    //添加一个容器
  <div class="login_container">
      //添加处理登录的盒子
    <div class="login_box">
      <div class="avatar_box">
        <!--头像，由于下列原bai因用户无法查看图像，alt 属性可以为图像提供替代的信息：-->
        <img src="../assets/logo.png" alt />
      </div>
      <!--添加表单-->
      <el-form
        ref="loginFormRef"
        :model="loginForm"
        :rules="loginRules"
        class="login_form"
        label-width="0px"
      >
        <el-form-item prop="username">
          <el-input v-model="loginForm.username" prefix-icon="iconfont icondenglu"></el-input>
        </el-form-item>
        <el-form-item prop="password">
          <el-input v-model="loginForm.password" prefix-icon="iconfont iconmima"></el-input>
        </el-form-item>
        <el-form-item class="btns">
          <el-button type="primary" @click="login">登录</el-button>
          <el-button type="info" @click="resetLoginForm">重置</el-button>
        </el-form-item>
      </el-form>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      loginForm: {
        username: "username",
        password: "password"
      },
      loginRules: {
        username: [
          { required: true, message: "请输入用户名", trigger: "blur" },
          { min: 5, max: 8, message: "长度在 5 到 8 个字符", trigger: "blur" }
        ],
        password: [
          { required: true, message: "请输入密码", trigger: "blur" },
          { min: 6, max: 8, message: "密码为 6~8 位", trigger: "blur" }
        ]
      }
    };
  },
  methods: {
    resetLoginForm() {
      this.$refs.loginFormRef.resetFields();
    },
    login() {
      this.$refs.loginFormRef.validate(async valid => {
        if (!valid) return;
        // 调用get请求
        const {data :res} = await this.$http.post("login", this.loginForm);
         if (res == "ok" ) {
           this.$message.success("登陆成功！！！");
           this.$router.push({ path: "/home"});// 路由
         }else{
          this.$message.error("登录失败！！！");
         }
      });
    }
  }
};
</script>

<style lang="less" scoped>

// 跟节点样式
.login_container {
  background-color: #2b4b6b;
  height: 100%;
}

.login_box {
  width: 450px;
  height: 300px;
  background-color: #fff;
  border-radius: 3px;// 圆角
  position: absolute;// 绝对定位
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);// 根据自己位置 以自己为长度位移

  .avatar_box {
    width: 130px;
    height: 130px;
    border: 1px solid #eee;
    border-radius: 50%; // 加圆角
    padding: 10px;
    box-shadow: 0 0 10px #ddd;// 盒子阴影
    position: absolute;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #0ee;
    img {
      width: 100%;
      height: 100%;
      border-radius: 50%; // 加圆角
      background-color: #eee;
    }
  }
  .btns {
    display: flex;// 弹性布局
    justify-content: flex-end; // 尾部对齐
  }
  .login_form {
    position: absolute;
    bottom: 0%;
    width: 100%;
    padding: 0 10px;
    box-sizing: border-box;// 设置边框
  }
}
</style>
```

#### 2.2.4、修改main.js

```js
import Vue from 'vue'
import App from './App.vue'
import router from './router'
import './plugins/element.js'
import './assets/css/global.css'
// 导入iconfront
import './assets/font/iconfont.css'
// 导入axios
import axios from 'axios'
// 挂载axios 到Vue的原型prototype的$http
Vue.prototype.$http = axios
// 设置请求的根路径
axios.defaults.baseURL = "http://localhost:9000/"
axios.interceptors.request.use(config => {
  console.log(config);
  // 请求头挂载信息
  config.headers.Authorization = window.sessionStorage.getItem("flag");
  // 在最后必须return config
  return config;
})
Vue.config.productionTip = false

new Vue({
  router,
  render: h => h(App)
}).$mount('#app')

```

#### 2.2.5、创建Home页面

```html
<template>
    <div>
        Home
    </div>
</template>
<script>
 
</script>
<style lang="less" scoped>

</style>
```

添加home的路由后访问。

## 3、完善登录

### 3.1.后台开发

#### 3.1.1、创建user实体

| 名称     | 类型    | 描述     |
| -------- | ------- | -------- |
| id       | int     | 主键id   |
| username | String  | 用户名   |
| password | String  | 密码     |
| email    | String  | 邮箱     |
| role     | String  | 角色类型 |
| state    | boolean | 启用标识 |

#### 3.1.2、创建userdao

会根据用户输入的`用户名`和`密码`来获取信息，方法名`getUserByMassage`

```java
@Repository
public int getUserByMassage(@Param("username") String username, @Param("password") String password);
```

#### 3.1.3、编写usermapper

mybatis的映射文件

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="">
     <select id="getUserByMassage" resultType="java.lang.Integer">
       	SELECT count(id) FROM easyUser
       	WHERE username=#{username} AND password=#{password} AND state = 1
    </select>
</mapper>
```

查询条件：`SELECT count(id) FROM easyUser WHERE username='xxx' AND password='xxx' AND state = 1`

#### 3.1.4、创建UserController

使用传递过来的username和password入参dao的`getUserByMassage`方法

```java
@RequestMapping("/login")
    public String userLogin(@RequestBody User user) {
        System.out.println("User : " + user);
        String str = "error";
        int count = userDao.getUserByMassage(user.getUsername(), user.getPassword());
        if (count > 0) {
            str = "ok";
        }
        return str;
    }
```

查询结果大于0后，证明查询有结果，登录就应该成功，之前我们页面的判断条件是结果返回是否为“ok”。

☆ 如果用户名做了去重这里的判断应该是等于1。

#### 3.1.5、路由守卫

首先登录成功后，希望设置一个保存信息。所以修改查询语句：

`SELECT * FROM easyUser WHERE username='admin' AND password='123456' AND state = 1`

修改返回值“ok”，创建map存放查询出的user和flag，转化json字符串，返回在pom.xml里添加json依赖,使用JSON.toJSONString转化对象为json

前台修改接收信息内容，获得登录的user，保存到客户端的 sessionStorage中。

```js
window.sessionStorage.setItem('flag','ok');
```

在index.js里创建路由导航

![image-20200922185800021](E:\Download\Typora\image-20200922185800021.png)

```js
// 挂载路由导航守卫
router.beforeEach((to, from, next) => {
  // to:将要访问的路径
  // from:从哪里访问的路径
  // next:之后要做的任务，是一个函数
  //    next（）放行， next（'/URL'）强制跳转的路径。
  if (to.path == '/login') return next();// 访问路径为登录
  // 获取flag
  const flagStr = window.sessionStorage.getItem("flag");// session取值
  if (!flagStr) return next('/login');// 没登录去登录
  next();
})

// 出现问题的时候使用
const originalPush = VueRouter.prototype.push
VueRouter.prototype.push = function push(location, onResolve, onReject) {
  if (onResolve || onReject) return originalPush.call(this, location, onResolve, onReject)
  return originalPush.call(this, location).catch(err => err)
}
```

#### 3.1.6、安全退出

添加安全退出按钮标签

```html
 <el-button type="info" @click="logout">安全退出</el-button>
```

添加安全退出方法

```js
    logout() {
      window.sessionStorage.clear();
      this.$router.push("/login");
    },
```

### 3.2.数据创建

 略

## 4、Home页开发

根据主页规划，修改Home。

#### 安全退出

![image-20200922184453466](E:\Download\Typora\image-20200922184453466.png)

但是F12 的时候，发现缓存还在：

![image-20200922184712461](E:\Download\Typora\image-20200922184712461.png)

解决：

![image-20200922184759390](E:\Download\Typora\image-20200922184759390.png)

### 4.1 引入container布局

https://element.eleme.cn/#/zh-CN/component/container

![image-20200922190558430](E:\Download\Typora\image-20200922190558430.png)

注意：有了 <el-container>，就不能有div，那么把退出按钮放在布局的头部

```html
    <el-container class="home-container">
      <el-header>Header</el-header>
      <el-container>
        <el-aside width="200px">Aside</el-aside>
        <el-main>Main</el-main>
      </el-container>
    </el-container>
```

添加背景

```css
.el-header {
  background-color: #373d41;
}
.el-aside {
  background-color: #333744;
}
.el-main {
  background-color: #eaedf1;
}
```

布局充满

![image-20200922190905322](E:\Download\Typora\image-20200922190905322.png)

注意报错：

![image-20200922191417552](E:\Download\Typora\image-20200922191417552.png)

原因分析：

```xml
分析：以上运行时第一次点击登陆出现错误，第二次点击登陆正常进入主页，原因是在第一次登陆时守卫路由没有拿到token的值，

如图，先触发了守卫路由再放置token。
这时：守卫路由无法先拿到token，直接进行了/login的跳转，
先进行了页面的跳转，因此因此守卫路由中断当前的导航（本次跳转），抛出异常，无法进入首页，第二次登陆能够登入首页是因为第一次登陆已经放好了token，因此正常拿到token也就能正常走这个函数了。
```

![image-20200922191624184](E:\Download\Typora\image-20200922191624184.png)



![image-20200922191459107](E:\Download\Typora\image-20200922191459107.png)



```css
.home-container {
  height: 100%;
}
```

### 4.2 完善Header

![image-20200922192156001](E:\Download\Typora\image-20200922192156001.png)

![image-20200922192334072](E:\Download\Typora\image-20200922192334072.png)

```html
  <el-header>
      <div>
        <img src="../assets/logo.jpg" alt class="logo_img" />
        <span>运动管理平台</span>
      </div>
      <el-button type="info" @click="logout">安全退出</el-button>
    </el-header>
```

样式

![image-20200922192733502](E:\Download\Typora\image-20200922192733502.png)

```css
.el-header {
  background-color: #373d41;
  display: flex;
  justify-content: space-between;// 左右贴边
  padding-left: 0%;// 左边界
  align-items: center;// 水平
  color: #fff;
  font-size: 20px;
  > div { //左侧div加布局
    display: flex;
    align-items: center;
    span {
      margin-left: 15px;
    }
  }
}

.logo_img{
  width: 55px;
  height: 55px;
}
```

### 4.3 左侧菜单布局

https://element.eleme.cn/#/zh-CN/component/menu

找到自定义开始copy

![image-20200922193011889](E:\Download\Typora\image-20200922193011889.png)

```js
 <el-menu
      default-active="2" //去除默认选择项和类不要。
      class="el-menu-vertical-demo" //去除默认选择项和类不要。
      @open="handleOpen"  //方法不要
      @close="handleClose"//方法不要
      background-color="#545c64"  //留背景颜色
      text-color="#fff"//字体颜色
      active-text-color="#ffd04b">//选中的字体颜色 ，可改成蓝色：#409eff
      <el-submenu index="1">
        <template slot="title">
          <i class="el-icon-location"></i>
          <span>导航一</span>
        </template>
        <el-menu-item-group>
          <template slot="title">分组一</template>
          <el-menu-item index="1-1">选项1</el-menu-item>
          <el-menu-item index="1-2">选项2</el-menu-item>
        </el-menu-item-group>
        <el-menu-item-group title="分组2">
          <el-menu-item index="1-3">选项3</el-menu-item>
        </el-menu-item-group>
        <el-submenu index="1-4">
          <template slot="title">选项4</template>
          <el-menu-item index="1-4-1">选项1</el-menu-item>
        </el-submenu>
      </el-submenu>
      <el-menu-item index="2">
        <i class="el-icon-menu"></i>
        <span slot="title">导航二</span>
      </el-menu-item>
      <el-menu-item index="3" disabled>
        <i class="el-icon-document"></i>
        <span slot="title">导航三</span>
      </el-menu-item>
      <el-menu-item index="4">
        <i class="el-icon-setting"></i>
        <span slot="title">导航四</span>
      </el-menu-item>
    </el-menu>
```

以上的效果：

![image-20200922194631523](E:\Download\Typora\image-20200922194631523.png)

不想要太多导航和太多层级：

​	（1）删除index2及以下：

![image-20200922194717862](E:\Download\Typora\image-20200922194717862.png)

![image-20200922195435364](E:\Download\Typora\image-20200922195435364.png)

```html
     <el-aside :width="isCollapse ?'64px':'200px'">
        <!--伸缩按钮-->
        <div class="toggle-button" @click="toggleCollapase">|||</div>
        <!--侧边栏菜单区 unique-opened="true" 只保持一个菜单展开 router开启路由-->
        <el-menu background-color="#545c64" text-color="#fff" active-text-color="#409eff" 		unique-opened :collapse="isCollapse" :collapse-transition="false" :router="true">
          <el-submenu :index="item.id+''" v-for="item in menuList" :key="item.id">
            <template slot="title">
              <i :class="iconsObject[item.id]"></i>
              <span>{{item.title}}</span>
            </template>
            <el-menu-item  :index="it.id+''" v-for="it in item.slist" :key="it.id">
              <template slot="title" >
                <i :class="iconsObject[it.id]"></i>
                <span>{{it.title}}</span>
              </template>
            </el-menu-item>
          </el-submenu>
        </el-menu>
      </el-aside>
```

### 4.4 访问左侧菜单数据

#### 4.4.1 页面加载请求数据

说明，这个左侧菜单应该一进来就会产生的，所以应该放在created方法里面

![image-20200922200023698](E:\Download\Typora\image-20200922200023698.png)

```js
  // 类似onload
  created() {
      this.getMenuList();
  },
 methods里面     
  // 获取所有的导航菜单
    async getMenuList(){
      const {data:res} = await this.$http.get("menus");
      console.log(res.data);
      if( res.status != 200) return this.$message.error("操作失败！！！");
      this.menuList = res.data;
    },
```

#### 4.4.2 定义菜单列表对象

```js
// 左侧菜单
menuList: [],
iconsObject: {
   '100':'iconfont iconguanliyuan',
   '200':'iconfont iconsport',
   '101':'iconfont icondenglu',
   '102':'iconfont iconmima',
   '103':'iconfont iconsport',
   '104':'iconfont iconshangpin',
   '201':'iconfont iconshu',
   '202':'iconfont iconkaluli',
   '203':'iconfont iconshiwu',
   '204':'iconfont icondenglu',
},
```

#### 4.4.3 定义menu后台

bean实体

```java
public class SubMenu {
    private int id;
    private String title;
    private String path;
```

```java
public class MainMenu {
    private int id;
    private String title;
    private String path;
    List<SubMenu> slist;
```

![image-20200922201101682](E:\Download\Typora\image-20200922201101682.png)

控制器

```java
@RestController
public class MenuController {
    @Autowired
    MenuDao menuDao;

    @RequestMapping("/menus")
    public String getAllMenus(){
        HashMap<String, Object> data = new HashMap<>();
        List<MainMenu> mainMenus = menuDao.getMainMenus();
        data.put("data",mainMenus);
        data.put("status",200);
        String data_json = JSON.toJSONString(data);
        System.out.println("成功访问！！！");
        return data_json;
    }
}
```

dao层接口类

```java
@Repository
public interface MenuDao {
    public List<MainMenu> getMainMenus();
}
```

映射文件

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.naughty.userlogin02.dao.MenuDao">
    <!--映射实体-->
    <resultMap id="menuMap" type="com.naughty.userlogin02.bean.MainMenu">
        <id column="id"  property="id"></id>
        <result column="title"  property="title"></result>
        <result column="path"  property="path"></result>
        <collection  property="slist" ofType="com.naughty.userlogin02.bean.SubMenu">
            <result column="sid"  property="id"></result>
            <result column="stitle"  property="title"></result>
            <result column="spath"  property="path"></result>
        </collection>
    </resultMap>

    <select id="getMainMenus" resultMap="menuMap">
        SELECT mm.*,sm.id as sid ,sm.title as stitle,sm.path as spath FROM mainmenu mm ,submenu sm WHERE mm.id = sm.mid;
    </select>
</mapper>
```

发送请求到后台：

![image-20200922202557328](E:\Download\Typora\image-20200922202557328.png)

测试：

![image-20200922203032528](E:\Download\Typora\image-20200922203032528.png)

![image-20200922203101039](E:\Download\Typora\image-20200922203101039.png)

##### 跑通前后台，拿到菜单数据后：

用v-for语句：

循环遍历，并唯一标识key和item.id数据绑定

![image-20200922203541151](E:\Download\Typora\image-20200922203541151.png)

同理一级菜单和二级菜单

![image-20200922204202331](E:\Download\Typora\image-20200922204202331.png)

但是页面中有个小bug：

![image-20200922204255442](E:\Download\Typora\image-20200922204255442.png)

原因分析：

![image-20200922204527353](E:\Download\Typora\image-20200922204527353.png)

若想每次保证只打开一个一级菜单：

![image-20200922204948850](E:\Download\Typora\image-20200922204948850.png)



修改如下：

![image-20200922204721250](E:\Download\Typora\image-20200922204721250.png)

#### 4.4.4 消除对不齐的线

![image-20200922205051430](E:\Download\Typora\image-20200922205051430.png)

![image-20200922205200020](E:\Download\Typora\image-20200922205200020.png)

```java
.el-aside {
  background-color: #333744;
  .el-menu{
    border-right: none;// 对其右边框
  }
}
```

### 4.5 折叠按钮

添加折叠按钮

![image-20200922205649662](E:\Download\Typora\image-20200922205649662.png)

```html
<div class="toggle-button" @click="toggleCollapase">|||</div>
```

修改按钮样式

```css
.toggle-button{
  background-color:#4A5064;
  font-size: 10px;
  line-height: 24px;
  color:#fff;  纯白
  text-align: center;
  letter-spacing: 0.2em;
  cursor: pointer;// 显示鼠标指针为：小手
}
```

定义按键方法

![image-20200922205814364](E:\Download\Typora\image-20200922205814364.png)

```js
// 切换菜单折叠与展开
 toggleCollapase(){
 this.isCollapse = !this.isCollapse;
},
```

![image-20200922205945258](E:\Download\Typora\image-20200922205945258.png)

效果：

![image-20200922210225045](E:\Download\Typora\image-20200922210225045.png)

根据这个collapse属性的false和true值，来确定是否展开，所以把这个属性绑定一个变量：isCollapse

![image-20200922210641158](E:\Download\Typora\image-20200922210641158.png)

![image-20200922210654198](E:\Download\Typora\image-20200922210654198.png)

新建方法：

![image-20200922210707178](E:\Download\Typora\image-20200922210707178.png)

但是发现以下不收缩：

![image-20200922210903703](E:\Download\Typora\image-20200922210903703.png)

解决方法：

查看收缩时的宽度：为64

![image-20200922212152712](E:\Download\Typora\image-20200922212152712.png)

所以在以下地方设置：

![image-20200922212227740](E:\Download\Typora\image-20200922212227740.png)

关闭折叠转换效果：

```js
:collapse-transition="false"
```



```html
<active-text-color="#409eff" unique-opened :collapse="isCollapse" 
          :collapse-transition="false"
```



修改侧边栏宽度

```html
 <el-aside :width="isCollapse ?'64px':'200px'">
```

##### 显示不同图标（根据每个菜单的不同）

本来可以根据后台存储在数据库的，但是现在不这么做了，由前端来：

![image-20200923082953759](E:\Download\Typora\image-20200923082953759.png)

![image-20200923083010356](E:\Download\Typora\image-20200923083010356.png)

### 4.6 路由重定向

#### 主体页面

![image-20200923085304967](E:\Download\Typora\image-20200923085304967.png)

#### 4.6.1 创建Welcome组价

```html
<template>
    <div class="main_welcome">
        <h3>Welcome!!!</h3>
    </div>
</template>
<style lang="less" scoped>

</style>
<script>
export default {
    
}
</script>
```

#### 4.6.2 配置重定向（index.js路由）

![image-20200923085805833](E:\Download\Typora\image-20200923085805833.png)

```js
  {
    path: '/home',
    component: Home,
    redirect: '/welcome',
    children: [
      { path:'/welcome', component: Welcome}
    ],
  },
```

#### 4.6.3 侧边栏路由链接

先在侧边栏加入路由属性，因为不可能左边每个菜单都写一个页面：

![image-20200923090241953](E:\Download\Typora\image-20200923090241953.png)

但是效果如下：

![image-20200923090321345](E:\Download\Typora\image-20200923090321345.png)

![image-20200923090333042](E:\Download\Typora\image-20200923090333042.png)

```html
 <el-menu background-color="#545c64" text-color="#fff" active-text-color="#409eff" unique-opened :collapse="isCollapse" :collapse-transition="false"  :router="true">
```

解决：

先admin组件开发：见下段

之后修改每一个次级菜单的路径

```html
<el-menu-item  :index="it.path+''" v-for="it in item.slist" :key="it.id">
```

## 5、admin组件开发

### 5.1 创建user组件

（1）在components下新建admin文件夹，在admin文件夹下创建`user.vue`

![image-20200923090700643](E:\Download\Typora\image-20200923090700643.png)

（2）把新建的加入路由：

![image-20200923091317227](E:\Download\Typora\image-20200923091317227.png)

（3）在Home页面的唯一标识改成数据库中的地址：

那么前端就会通过:router="true"拼接成：

![image-20200923091650115](E:\Download\Typora\image-20200923091650115.png)

最终效果：

![image-20200923091716522](E:\Download\Typora\image-20200923091716522.png)

现在主页面的效果就是：

一进来出现welcome（由重定向实现的），然后点击用户列表会出现用户列表子页面

```html
<template>
  <div>
  	userlist!!!
  </div>
</template>
<script>
</script>
<style lang="less" scoped>
</style>
```

### 5.2 添加新路由

index.js下home添加新的子组件

```js
  {
    path: '/home',
    component: Home,
    redirect: '/welcome',
    children: [
      { path:'/welcome', component: Welcome},{ path:'/user', component: User}
    ],
  },
```

### 5.3 路径高亮

home组件中添加一个新的属性default-active

```html
<el-menu background-color="#545c64" text-color="#fff" active-text-color="#409eff" unique-opened :collapse="isCollapse" :collapse-transition="false"  :router="true" default-active="/user">
```

![image-20200923092426626](E:\Download\Typora\image-20200923092426626.png)

效果就是：多次点击刷新按钮都会默认选择用户列表高亮

但是我们需要进来默认激活的路径是welcome：

![image-20200923092840446](E:\Download\Typora\image-20200923092840446.png)

![image-20200923092851497](E:\Download\Typora\image-20200923092851497.png)

那么进入页面后需要满足点击二级菜单后，跳转到另一个页面：

那么就是在二级菜单增加一个按钮监听：

![image-20200923093732043](E:\Download\Typora\image-20200923093732043.png)

![image-20200923093746545](E:\Download\Typora\image-20200923093746545.png)

但是以上的页面刷新后，这个选择高亮就没有了，如下：

![image-20200923093857694](E:\Download\Typora\image-20200923093857694.png)

那么选择把它存储到缓存，然后在再次加载的时候，取出来初始化：

![image-20200923094156911](E:\Download\Typora\image-20200923094156911.png)



创建`连接激活`事件

```html
<el-menu-item  :index="it.path+''" v-for="it in item.slist" :key="it.id"  @click="saveNavState(it.path+'')">
```

创建`连接激活`属性

```js
// 被激活的连接
activePath:'',
```

```html
<el-menu background-color="#545c64" text-color="#fff" active-text-color="#409eff" unique-opened :collapse="isCollapse" :collapse-transition="false"  :router="true" :default-active="activePath">
```



创建 `连接激活`方法

```js
saveNavState(activePath){
	 window.sessionStorage.setItem('activePath',activePath);// 存放点击的二级菜单
     this.activePath = activePath;// 给点击的菜单添加高亮
},
```

修改create方法

```js
  created() {
      this.getMenuList();
      this.activePath = window.sessionStorage.getItem('activePath');// 取出session里的访问路径
  },
```

![image-20200602152626482](C:\Users\dz_yk\AppData\Roaming\Typora\typora-user-images\image-20200602152626482.png)

## 6、用户列表组件开发

### 6.1 面包屑导航区

![image-20200923094523064](E:\Download\Typora\image-20200923094523064.png)

![image-20200923094540670](E:\Download\Typora\image-20200923094540670.png)

```html
 <!-- 面包屑导航 -->
    <el-breadcrumb separator-class="el-icon-arrow-right">
      <el-breadcrumb-item :to="{ path: '/home' }">首页</el-breadcrumb-item>
      <el-breadcrumb-item>权限管理</el-breadcrumb-item>
      <el-breadcrumb-item>用户列表</el-breadcrumb-item>
    </el-breadcrumb>
```

`全局样式`表里修改样式

```css
/* 面包屑样式 */
.el-breadcrumb{
    margin-bottom: 15px;
    font-size: 12px;
}
```

### 6.2 卡片视图区

#### 用户列表主体部分



```html
 <!-- 卡片视图区 -->
<el-card>
</el-card>
```

全局card样式

![image-20200923095012859](E:\Download\Typora\image-20200923095012859.png)

![image-20200923094950128](E:\Download\Typora\image-20200923094950128.png)

```css
/* 卡片区域  !important 提高样式级别 */
.el-card{
    box-shadow: 0 1px 1px rgba(0, 8, 10, 0.15) !important;
}
```

添加搜索组件并且使用栅格

​	（1）添加搜索框：

![image-20200923095328926](E:\Download\Typora\image-20200923095328926.png)

![image-20200923095343471](E:\Download\Typora\image-20200923095343471.png)

​	（2）添加一个按钮：

![image-20200923095531097](E:\Download\Typora\image-20200923095531097.png)

效果排在两排了

![image-20200923095654006](E:\Download\Typora\image-20200923095654006.png)

​	（3）那么把以上两部分用<el-row >包起来进行格式设置：

![image-20200923100215579](E:\Download\Typora\image-20200923100215579.png)



```html
 <!-- 卡片视图区 -->
    <el-card>
      <el-row :gutter="25"> 间隙
        <el-col :span="10"> 列宽
          <!-- 搜索添加 -->
          <el-input placeholder="请输入搜索内容" v-model="queryInfo.query" clearable @clear="getUserList">
            <el-button slot="append" icon="el-icon-search" @click="getUserList"></el-button>
          </el-input>
        </el-col>
        <el-col :span="4">
          <el-button type="primary" @click="addDialogVisible = true">添加用户</el-button>
        </el-col>
      </el-row>
```

## 7、用户数据获取

### 7.1、前台组件

create方法

![image-20200923100330819](E:\Download\Typora\image-20200923100330819.png)

```js
  created() {
    this.getUserList();
  },
```

获取用户方法

![image-20200923101840973](E:\Download\Typora\image-20200923101840973.png)

```js
 async getUserList() {
      // 调用post请求
      const { data: res } = await this.$http.get("allUser", {
        params: this.queryInfo
      });
      this.userlist = res.data; // 将返回数据赋值
      this.total = res.numbers; // 总个数
    },
```

封装查询方法需要的数据：

![image-20200923101718353](E:\Download\Typora\image-20200923101718353.png)

```js
 // 请求数据
queryInfo: {
  query: "",
  pageNum: 1,
  pageSize: 5
},
userlist: [],// 用户列表
total: 0, // 最大数据记录
```

#### 测试

![image-20200923102037889](E:\Download\Typora\image-20200923102037889.png)

![image-20200923102049982](E:\Download\Typora\image-20200923102049982.png)



### 7.2、用户列表后台

控制层

```java
   @RequestMapping("/allUser")
    public String getUserList(QueryInfo queryInfo){
        System.out.println(queryInfo);
        int numbers = userDao.getUserCounts("%"+queryInfo.getQuery()+"%");// 获取数据总数
        int pageStart = (queryInfo.getPageNum()-1)*queryInfo.getPageSize();
        List<User> users = userDao.getAllUser("%"+queryInfo.getQuery()+"%",pageStart,queryInfo.getPageSize());
        HashMap<String, Object> res = new HashMap<>();
        res.put("numbers",numbers);
        res.put("data",users);
        System.out.println("总条数："+numbers);
        String users_json = JSON.toJSONString(res);
        return users_json;
    }
```

dao层

```java
@Repository
public interface UserDao {
    public int getUserByMassage(@Param("username") String username, @Param("password") String password);
    public List<User> getAllUser(@Param("username") String username,@Param("pageStart") int pageStart, @Param("pageSize") int pageSize);
    public int getUserCounts(@Param("username") String username);
```

Mapper映射文件

```xml
    <select id="getAllUser" resultType="com.naughty.userlogin02.bean.User">
       	SELECT * FROM easyUser
        <if test="username !=null ">
            WHERE username like #{username}
        </if>
        LIMIT #{pageStart},#{pageSize}
    </select>

    <select id="getUserCounts" resultType="java.lang.Integer">
       	SELECT count(*) FROM `easyuser`
        <if test="username !=null ">
            WHERE username like #{username}
        </if>
    </select>
```

### 7.3、用户列表渲染

（1）添加表格总的和索引列

![image-20200923102427617](E:\Download\Typora\image-20200923102427617.png)

![image-20200923102437361](E:\Download\Typora\image-20200923102437361.png)

​	（2）同理

![image-20200923102859784](E:\Download\Typora\image-20200923102859784.png)

![image-20200923102846215](E:\Download\Typora\image-20200923102846215.png)

​	（3）引入展示状态的插槽：

![image-20200923103223229](E:\Download\Typora\image-20200923103223229.png)

![image-20200923103241273](E:\Download\Typora\image-20200923103241273.png)

（4）增加每行的增删改查按钮：

![image-20200923103551808](E:\Download\Typora\image-20200923103551808.png)

![image-20200923103612854](E:\Download\Typora\image-20200923103612854.png)

（5）全局给表格添加样式：

![image-20200923103851243](E:\Download\Typora\image-20200923103851243.png)



```html
<!-- 用户列表  border 边框 stripe 隔行变色 -->
<el-table :data="userlist" border stripe>
     <el-table-column type="index"></el-table-column><!--索引列-->
     <el-table-column label="姓名" prop="username"></el-table-column>
     <el-table-column label="邮箱" prop="email"></el-table-column>
     <el-table-column label="密码" prop="password"></el-table-column>
     <el-table-column label="角色" prop="role"></el-table-column>
     <el-table-column label="状态" prop="state">
     <!--作用域插槽 scope.row 存储了当前行的信息 -->
         <template slot-scope="scope"><!--数据模板-->
                <el-switch v-model="scope.row.state"></el-switch>
         </template>
     </el-table-column>
	 <!--自定义插槽-->
     <el-table-column label="操作">
          <template slot-scope="scope">
            <!-- 修改 -->
            <el-button type="primary" icon="el-icon-edit" size="mini" @click="showEditDialog(scope.row.id)"></el-button>
            <!-- 删除 -->
            <el-button type="danger" icon="el-icon-delete" size="mini" @click="deleteUser(scope.row.id)"></el-button>
            <!-- 权限 -->
            <el-tooltip effect="dark" content="分配权限" placement="top-start" :enterable="false"><!--文字提示 enterable 隐藏-->
              <el-button type="warning" icon="el-icon-setting" size="mini"></el-button>
            </el-tooltip>
          </template>
	</el-table-column>
</el-table>
```

这里自己后台测试：

![image-20200923134023895](E:\Download\Typora\image-20200923134023895.png)

![image-20200923134046519](E:\Download\Typora\image-20200923134046519.png)

![image-20200923134058936](E:\Download\Typora\image-20200923134058936.png)



## 8、分页组件

https://element.eleme.cn/#/zh-CN/component/pagination

![image-20200923134350548](E:\Download\Typora\image-20200923134350548.png)

![image-20200923134433491](E:\Download\Typora\image-20200923134433491.png)

拿过来初始化：

![image-20200923134824140](E:\Download\Typora\image-20200923134824140.png)

页面效果

![image-20200923134933485](E:\Download\Typora\image-20200923134933485.png)

### 8.1、分页组件渲染

![image-20200923135122073](E:\Download\Typora\image-20200923135122073.png)

```html
<!-- 分页 size-change 每页最大数变化 current-change 页数变化 layout 功能组件-->
<el-pagination
        @size-change="handleSizeChange"
        @current-change="handleCurrentChange"
        :current-page="queryInfo.pageNum"
        :page-sizes="[1, 2, 5, 100]"
        :page-size="queryInfo.pageSize"
        layout="total, sizes, prev, pager, next, jumper"
        :total="total"
></el-pagination>
```

### 8.2、相关方法

```java
// 监听pageSize改变的事件
handleSizeChange(newSize) {
	this.queryInfo.pageSize = newSize;
	this.getUserList(); // 数据发生改变重新申请数据
},
// 监听pageNum改变的事件
handleCurrentChange(newPage) {
	this.queryInfo.pageNum = newPage;
	this.getUserList(); // 数据发生改变重新申请数据
},
```

## 9、用户状态修改

### 9.1、绑定change方法

![image-20200923142225876](E:\Download\Typora\image-20200923142225876.png)

```html
<!--作用域插槽 scope.row 存储了当前行的信息 -->
<template slot-scope="scope"><!--数据模板-->
	<el-switch v-model="scope.row.state" @change="userStateChanged(scope.row)"></el-switch>
</template>
```

### 9.2、创建changeState方法

![image-20200923142237366](E:\Download\Typora\image-20200923142237366.png)

```java
// 修改用户状态
async userStateChanged(userinfo) {
	const { data: res } = await this.$http.put(
        `userState?id=${userinfo.id}&state=${userinfo.state}`
    );
    if (res != "success") {
        userinfo.state = !userinfo.state;
        return this.$message.error("操作失败！！！");
      }
    this.$message.success("操作成功！！！");
},
```

![image-20200923135559907](E:\Download\Typora\image-20200923135559907.png)

### 9.3、修改状态后台

#### dao层编写接口

注意：不然会报错找不到参数

![image-20200923142115128](E:\Download\Typora\image-20200923142115128.png)

```java
@Repository
public interface UserDao {
    public int updateState(Integer id, Boolean state);
}
```

#### dao的映射文件

```xml
<update id="updateState">
   UPDATE easyuser SET state = #{state} WHERE id = #{id}
</update>
```

#### controller层编写

```java
@RequestMapping("/userState")
public String updateUserState(@RequestParam("id") Integer  id,
                                  @RequestParam("state") Boolean state){
	int i = userDao.updateState(id, state);
	String str = i >0?"success":"error";
	return str;
}
```

## 10、搜索功能实现



### 10.1、搜索组件完善

（1）给查询框做双向绑定

![image-20200923142444369](E:\Download\Typora\image-20200923142444369.png)

（2）添加清空功能，当没有查询时候，再次调用查询用户列表方法

![image-20200923142621379](E:\Download\Typora\image-20200923142621379.png)

（3）给按钮点击添加操作

![image-20200923142712618](E:\Download\Typora\image-20200923142712618.png)

```html
<!-- 搜索添加 双向绑定搜索信息 clearable 清除功能 -->
<el-input placeholder="请输入搜索内容" v-model="queryInfo.query" clearable @clear="getUserList">
	<el-button slot="append" icon="el-icon-search" @click="getUserList"></el-button>
</el-input>
```

### 10.2、添加用户

#### 后台

![image-20200923142905906](E:\Download\Typora\image-20200923142905906.png)

![image-20200923142923616](E:\Download\Typora\image-20200923142923616.png)

所有注册的用户全是普通用户：

![image-20200923143942277](E:\Download\Typora\image-20200923143942277.png)



#### 前端

#### （1）添加对话框

![image-20200923144744949](E:\Download\Typora\image-20200923144744949.png)

![image-20200923151126429](E:\Download\Typora\image-20200923151126429.png)

![image-20200923151141842](E:\Download\Typora\image-20200923151141842.png)

#### （2）增加close方法

![image-20200923144817106](E:\Download\Typora\image-20200923144817106.png)

#### （3）添加form表单

1、添加绑定：

![image-20200923145102263](E:\Download\Typora\image-20200923145102263.png)

![image-20200923145048074](E:\Download\Typora\image-20200923145048074.png)

2、添加规则

![image-20200923145121500](E:\Download\Typora\image-20200923145121500.png)

![image-20200923145230699](E:\Download\Typora\image-20200923145230699.png)

3、添加ref

![image-20200923145614031](E:\Download\Typora\image-20200923145614031.png)

![image-20200923145514066](E:\Download\Typora\image-20200923145514066.png)

4、输入框

![image-20200923145801877](E:\Download\Typora\image-20200923145801877.png)

#### （4）底部确认和取消按钮

![image-20200923150029460](E:\Download\Typora\image-20200923150029460.png)

#### （5）编写add方法

先校验；

![image-20200923150319194](E:\Download\Typora\image-20200923150319194.png)

### 10.3、删除用户

#### 后台

![image-20200923151636981](E:\Download\Typora\image-20200923151636981.png)

![image-20200923151701277](E:\Download\Typora\image-20200923151701277.png)

![image-20200923151711790](E:\Download\Typora\image-20200923151711790.png)

#### 前端

#### （1）加入按钮方法

![image-20200923152031257](E:\Download\Typora\image-20200923152031257.png)

#### （2）实现删除方法：

1、先用element自带的提示框

![image-20200923152309304](E:\Download\Typora\image-20200923152309304.png)

2、删除逻辑

![image-20200923152346843](E:\Download\Typora\image-20200923152346843.png)

### 10.4、编辑用户

#### 后台

![image-20200923152852732](E:\Download\Typora\image-20200923152852732.png)

![image-20200923152909114](E:\Download\Typora\image-20200923152909114.png)

![image-20200923153003593](E:\Download\Typora\image-20200923153003593.png)

![image-20200923153048028](E:\Download\Typora\image-20200923153048028.png)

![image-20200923153058484](E:\Download\Typora\image-20200923153058484.png)



#### 前端

#### （1）修改用户信息的变量

#### （2）显示或则隐藏表单的变量

![image-20200923153416137](E:\Download\Typora\image-20200923153416137.png)

#### （3）添加编辑的表单验证

![image-20200923153534443](E:\Download\Typora\image-20200923153534443.png)

#### （4）添加修改对话框

copy一下添加对话框

![image-20200923154030040](E:\Download\Typora\image-20200923154030040.png)

![image-20200923154101634](E:\Download\Typora\image-20200923154101634.png)

![image-20200923154128184](E:\Download\Typora\image-20200923154128184.png)

#### （5）显示对话框

![image-20200923154450626](E:\Download\Typora\image-20200923154450626.png)















